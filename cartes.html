<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Cartes du Labyrinthe</title>

  
  <link rel="stylesheet" href="mods/webp2/theme/css/style.css">
  <script src="core/allcards.js"></script>
  <script src="core/front.js"></script>
</head>
<body>

  <h1>Cartes du Labyrinthe</h1>

  <script>
    const deck = {
      folder:"mods/webp2/theme/images/",
      cards:[],
      setHeader: function(data,type,card){
          const cardheader = front.createDiv({
              attributes: {className:'card-header'}
          })
          // const cardtype = front.createDiv({
          //     attributes: {className:'type'}
          // })
          const cardName = front.createDiv({
              attributes: {className:'card-name',textContent:`${data.name}`},
              append:cardheader
          })
          card.appendChild(cardheader)
      },
      setFooter: function(data,type,card){
          const cardFooter = front.createDiv({
              attributes: {className:'card-footer'}
          })
          const cardDespription = front.createDiv({
              tag:'p',
              attributes: {className:'card-description',textContent:`${data.description}`},
              append:cardFooter
          })
          const cardAccroche = front.createDiv({
              tag:'p',
              attributes: {className:'card-accroche',textContent:`${data.accroche}`},
              append:cardFooter
          })
          if (type=='fight'){
            const cardCoeur = front.createDiv({
                attributes: {className:'card-coeur'},
                append:cardFooter
            })
            const cardStats = front.createDiv({
                attributes: {className:'card-stats'},
                append:cardFooter
            })
            const statsHp = front.createDiv({
                attributes: {className:'card-stats-hp',textContent:`❤️${data.stats.hp.cur}/${data.stats.hp.max}`},
                append:cardStats
            })
            const statsOr = front.createDiv({
                attributes: {className:'card-stats-or',textContent:`🪙${data.reward.or[0]}-${data.reward.or[1]}`},
                append:cardStats
            })
            //⏱️🪙⌛
            let cycle = data.attack.cycle.filter(val => val === 1).length
            let length = data.attack.cycle.length
            const statsRound = front.createDiv({
                attributes: {className:'card-stats-round',textContent:`⌛${cycle}/${length} `},
                append:cardStats
            })
            const statsDps = front.createDiv({
                attributes: {className:'card-stats-dps',textContent:`🗡️${data.attack.dps[0]}-${data.attack.dps[1]} `},
                append:cardStats
            })
          }
          card.appendChild(cardFooter)
      },
      setFooterEncounter: function(data,type,card){
          const cardFooter = front.createDiv({
              attributes: {className:'card-footer'}
          })
          const cardDespription = front.createDiv({
              tag:'p',
              attributes: {className:'card-description',textContent:`${data.description}`},
              append:cardFooter
          })
          const cardAccroche = front.createDiv({
              tag:'p',
              attributes: {className:'card-accroche',textContent:`${data.accroche}`},
              append:cardFooter
          })
          card.appendChild(cardFooter)
      },
      addCardEvent: function(card){
        card.addEventListener('click',function(){
          const modal = front.createDiv({
            attributes: {className:'modal'},
            append:document.body
          })
          const copy = card.cloneNode(true);
          modal.appendChild(copy)
          modal.addEventListener('click',function(){
            modal.remove()
          })
        })
      },
      displayRpgCards: function(LIST){
        
        const cards = front.createDiv({
          attributes: {className:'cards'}
        })  
        LIST.forEach(obj => {
            const type = Object.keys(obj)[0];
            const data = obj[type];
            const catFolder = (type === 'item' ? 'items/' : '');
            const picture = data.picture.replace('.png', '.webp');
            
            const card = front.createDiv({
              attributes: {className:'card '+ type},
              style:{backgroundImage:`url('${this.folder}${catFolder}${picture}')`}
            })
            this.addCardEvent(card)
            
            if(type=="fight"){
              this.setHeader(data,type,card)
              this.setFooter(data,type,card)
            }
            if(type=="item"){
              this.setHeader(data,type,card)
              this.setFooter(data,type,card)
            }
            else if (type=="rest"){
              this.setHeader(data,type,card)
              this.setFooter(data,type,card)
            }
            else if (type=="encounter"){
              this.setHeader(data,type,card)
              this.setFooterEncounter(data,type,card)
            }
            else if (type=="other"){
              this.setHeader(data,type,card)
              this.setFooter(data,type,card)
            }
            cards.appendChild(card)
          })
          this.container.appendChild(cards)
        },
      init: function(){
          this.container = front.createDiv({
            attributes: {className:'card-container'},
            style:{},
            append:document.body
          })
          this.displayRpgCards(fight)
          this.displayRpgCards(encounter)
          this.displayRpgCards(rest)
          this.displayRpgCards(other)
          this.displayRpgCards(item)
      },
    }
    deck.init()
  </script>

</body>
</html>
